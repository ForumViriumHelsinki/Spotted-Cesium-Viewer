<!DOCTYPE html>
<html lang="en">
<head>
<title>Helsinki Green Areas</title>
  <meta charset="utf-8">
  <!-- Include the CesiumJS JavaScript and CSS files -->
  <script src="lib/Cesium/Cesium.js"></script>
  <script type="text/javascript" src="services/geoapitools.js"></script>
  <script type="text/javascript" src="services/vegetation.js"></script>
  <script type="text/javascript" src="services/othernature.js"></script>
  <script type="text/javascript" src="services/sliderevents.js"></script>
  <script type="text/javascript" src="services/featurepicker.js"></script>
  <script type="text/javascript" src="services/trees.js"></script>
  <script type="text/javascript" src="services/water.js"></script>
  <script type="text/javascript" src="services/fields.js"></script>
  <script type="text/javascript" src="services/plots.js"></script>
  <script type="text/javascript" src="services/selectevents.js"></script>
  <script type="text/javascript" src="services/built.js"></script>
  <script type="text/javascript" src="services/district.js"></script>
  <script type="text/javascript" src="services/datasource.js"></script>
  <script type="text/javascript" src="services/ndvi.js"></script>
  <script type="text/javascript" src="services/greenareas.js"></script>
  <script type="text/javascript" src="services/cache.js"></script>
  <script type="text/javascript" src="services/ndviarea.js"></script>
  <script src="lib/localforage/dist/localforage.js"></script>
  <script src="lib/plotly-2.12.1.min.js"></script>
  <link href="lib/Cesium/Widgets/widgets.css" rel="stylesheet">
  <link href="styles/demoapp.css" rel="stylesheet">
</head>
<body>
<div id="canvasScalerDiv">
  <div id="cesiumContainer"></div>
  <div id="UIContainer">
  <p class="header">Spotted Viewer</p>
  
  <div id="UIContainer">
    <p class="header">Spotted Viewer</p>
    <div id="UIButtonContainer">
      <p class="uiReturnButton" id="returnButton" onClick="prevLevel()" style="color: black;">Previous district</p>
      <p class="uiButton" onClick="reset()" style="color: red;">Reset</p>
    </div>
    <!-- Rest of your UI elements -->

  <!-- Selects WMS layer -->
<select id="layerSelect">
  <option value="avoindata:Opaskartta_Helsinki" selected>Opaskartta</option>
  <option value="avoindata:Ortoilmakuva">Ortoilmakuva</option>
  <option value="avoindata:Ortoilmakuva_2022_5cm">Ortoilmakuva 2022</option>
  <option value="avoindata:Ortoilmakuva_2021_5cm">Ortoilmakuva 2021</option>
  <option value="avoindata:Ortoilmakuva_2020">Ortoilmakuva_2020</option>
  <option value="avoindata:Ortoilmakuva_2018">Ortoilmakuva_2018</option>
  <option value="avoindata:Ortoilmakuva_2016">Ortoilmakuva_2016</option>
  <option value="avoindata:Ortoilmakuva_2014">Ortoilmakuva_2014</option>
  <option value="avoindata:Kantakartta">Kantakartta</option>
  <option value="avoindata:Kiinteistokartta">Kiinteistokartta</option>
  <option value="avoindata:Karttasarja_PKS">Karttasarja PKS</option>
  <option value="avoindata:Vaaravariortoilmakuva_2022_5cm">V채채r채v채riortoilmakuva</option>
  <option value="avoindata:Ajantasa_asemakaava">Asemakaava</option>
  <option value="avoindata:Kaavahakemisto">Kaavahakemisto</option>
  <option value="avoindata:Rakennukset_alue_rekisteritiedot">Rakennukset alue rekisteritiedot</option>
  <option value="avoindata:Tavoitteellinen_viher_ja_virkistysverkosto_VISTRA">Tavoitteellinen viher- ja virkistysverkosto</option>
</select>

  <!-- Selects WMS layer -->
  <select id="NDVISelect" style = "display: none">
    <option value="NDVI" selected>NDVI March</option>
    <option value="NDVI_APRIL">NDVI April</option>
    <option value="NDVI_MAY">NDVI May</option>
    <option value="NDVI_JUNE">NDVI June</option>
    <option value="NDVI_JULY">NDVI July</option>
    <option value="NDVI_AUGUST">NDVI August</option>
    <option value="NDVI_SEPTEMBER">NDVI September</option>
    <option value="NDVI_OCTOBER">NDVI October</option>
  </select>

<!-- showPrintSwitch-->

<!-- showGreenSwitch-->
<label class="switch" id = "showGreenSwitch" >
  <input type="checkbox" id = "showGreenToggle" value = "showGreen" >
  <span class="slider round"></span>
</label>
<label for="showGreenToggle" class="label" id = "showGreenLabel" >YLRE green areas</label>


<!-- showPlotSwitch-->
<label class="switch" id = "showPlotSwitch" style = "display: none">
  <input type="checkbox" id = "showPlotToggle" value = "showPlot" >
  <span class="slider round"></span>
</label>
<label for="showPlotToggle" class="label" id = "showPlotLabel" style = "display: none">Display plot</label>

<!-- showNDVISwitch-->
<label class="switch"  id = "showNDVISwitch" style = "display: none">
  <input type="checkbox" id = "showNDVIToggle" value = "showNDVI">
  <span class="slider round"></span>
</label>
<label for="showNDVIToggle" class="label" id = "showNDVILabel" style = "display: none">NDVI</label>

<!-- NDVI2023Switch-->
<label class="switch"  id = "NDVI2023Switch" style = "display: none">
  <input type="checkbox" id = "NDVI2023Toggle" value = "NDVI2023">
  <span class="slider round"></span>
</label>
<label for="NDVI2023Toggle" class="label" id = "NDVI2023Label" style = "display: none">NDVI 2023</label>

<!-- YLRETimeSwitch-->
<label class="switch"  id = "YLRESwitch" style = "display: none">
  <input type="checkbox" id = "YLREToggle" value = "YLRE">
  <span class="slider round"></span>
</label>
<label for="YLREToggle" class="label" id = "YLRELabel" style = "display: none">YLRE green areas 2015-2023</label>

<!-- TreeRegistrySwitch-->
<label class="switch"  id = "TreeRegistrySwitch" style = "display: none">
  <input type="checkbox" id = "TreeRegistryToggle" value = "TreeRegistry">
  <span class="slider round"></span>
</label>
<label for="TreeRegistryToggle" class="label" id = "TreeRegistryLabel" style = "display: none">Tree Registry</label>

<!-- PopulationGridSwitch-->
<label class="switch"  id = "PopulationGridSwitch" style = "display: none">
  <input type="checkbox" id = "PopulationGridToggle" value = "PopulationGrid">
  <span class="slider round"></span>
</label>
<label for="PopulationGridToggle" class="label" id = "PopulationGridLabel" style = "display: none">Population grid</label>

<!-- SubDistrictNDVISwitch-->
<label class="switch"  id = "SubDistrictNDVISwitch" style = "display: none">
  <input type="checkbox" id = "SubDistrictNDVIToggle" value = "SubDistrictNDVI">
  <span class="slider round"></span>
</label>
<label for="SubDistrictNDVIToggle" class="label" id = "SubDistrictNDVILabel" style = "display: none">SubDistricts with NDVI</label>

<!-- showTreeSwitch-->
<label class="switch" id = "showTreesSwitch" style = "display: none">
  <input type="checkbox" id = "showTreeToggle" value = "showTree">
  <span class="slider round"></span>
</label>
<label for="showTreeToggle" class="label" id = "showTreesLabel" style = "display: none">Tree areas</label>

<!-- NDVI WMS-->
<label class="switch" id = "wmsNDVISwitch" >
  <input type="checkbox" id = "wmsNDVIToggle" value = "wmsNDVI" >
  <span class="slider round"></span>
</label>
<label for="wmsNDVIToggle" class="label" id = "wmsNDVI" >NDVI areas</label>

<!--  showLandCover-->
<label class="switch" id = "landCoverSwitch">
  <input type="checkbox" id="landCoverToggle" value="getLandCover" >
  <span class="slider round"></span>
</label>
<label for="landCoverToggle" class="label" id="landCoverLabel">HSY land cover</label>


</div>

    <div id="plotContainer">
  </div>

  <div id="printContainer"  style = "display: none">
    <i></i>
    </div>
        <!-- Labels for colors -->
        <label class="color-label white-label active" style = "display: none" id = "white-label"> -1 - 0</label>
        <label class="color-label yellow-label active" style = "display: none" id = "yellow-label">0 - 0.1</label>
        <label class="color-label yellowgreen-label active" style = "display: none" id = "yellowgreen-label">0.1 - 0.2</label>
        <label class="color-label lightgreen-label active" style = "display: none" id = "lightgreen-label">0.2 - 0.3</label>
        <label class="color-label green-label active" style = "display: none" id = "green-label">0.3 - 0.4</label>
        <label class="color-label ldarkgreen-label active" style = "display: none" id = "ldarkgreen-label">0.4 - 0.5</label>
        <label class="color-label darkgreen-label active" style = "display: none" id = "darkgreen-label">0.5 - 0.6</label>
        <label class="color-label vdarkgreen-label active" style = "display: none" id = "vdarkgreen-label">0.6 - 1</label>
  <div id="plotInhabitantContainer">
  </div>
  <div id="greenAreaContainer">
  </div>  
  <div id="plotPieContainer">
    <div id="selectContainer">
        <select id="plotSelect">
            <option value="Helsinki">Helsinki</option>
        </select>
    </div>
    <!-- Other content of the plot container -->
</div>

<div class="ndviSlider-container" id="ndviSliderContainer">
  <input type="range" id="ndviSlider" min="0" max="2" value="0">
  <span id="ndviSliderValue">NDVI</span>
</div>

<div class="ndviArea-container" id="ndviAreaContainer">
  <input type="range" id="ndviArea" min="0" max="7" value="3">
  <div class="slider-ticks-container"></div> <!-- Container for tick marks -->
    <span id="ndviAreaValue">June 2023</span>
</div>

<div class="ndviSlider-container2023" id="ndviSliderContainer2023">
  <input type="range" id="ndviSlider2023" min="0" max="11" value="0">
  <div class="slider-ticks-container"></div> <!-- Container for tick marks -->
</div>

<div class="ndviYlre-container" id="ndviYlreContainer">
  <input type="range" id="ndviYlre" min="0" max="8" value="8">
  <div class="slider-ticks-container"></div> <!-- Container for tick marks -->
    <span id="ndviYlreValue">June 2023</span>
</div>

<div class="slider-container" id="sliderContainer">
  <input type="range" id="blueSlider" min="0" max="5" value="0">
  <span id="sliderValue">distance from green area 0 km</span>
</div>
  		<!-- Add Logo -->
		
	<div class="logoHolder">	
	<img src="assets/images/spotted_logo.png" id="logoSpotted" alt="Spotted" />
	<img src="assets/images/fvh-1_musta.png" id="logoFVH" alt="Forum Virium Helsinki" />
  </div>
  
  </div>
  <script>
  
  	// UI related global variables...
  	var showPlot = true;
  	var print = true; //show object details..
    var nameOfZone = null;
    var averageHeatExposure = 0;
    var majorDistrict = null;
    var districtName = null;
    var majorDistrictName = null;
    var districtPopulation = null;
    var districtArea = null;
    var level = null;
    var districtsVisited = [ ];
    var levelsVisited = [ ];
    var currentDistrictName = null;
    var currentSubDistrictName = null;
    var ndviAreaDataSourceName = null;

	// OS version, operating without Cesium Ion services...
    Cesium.Ion.defaultAccessToken = null;
    setElementDisabledState( true );
    addSelectorEventListeners( );
    document.getElementById("showNDVIToggle").disabled = true;
    document.getElementById("NDVI2023Toggle").disabled = true;

    // Initialize the Cesium Viewer in the HTML element with the `cesiumContainer` ID.
    const viewer = new Cesium.Viewer('cesiumContainer', {
    	terrainProvider : new Cesium.EllipsoidTerrainProvider(),
    	imageryProvider: createImageryProvider( document.getElementById( 'layerSelect' ).value ),
    	animation: false,
      fullscreenButton: false,
      geocoder: false,
      shadows: false,
      navigationHelpButton: false,
      timeline: false,
      sceneModePicker: false,
      baseLayerPicker: false,
      infoBox: false,
	  homeButton: false
    });  
    
    // Fly the camera to Helsinki at the given longitude, latitude, and height.
    viewer.camera.flyTo({
      destination : Cesium.Cartesian3.fromDegrees(24.901745, 60.195464, 33000), 
      orientation : {
        heading : Cesium.Math.toRadians(0.0),
        pitch : Cesium.Math.toRadians(-85.0),
      }
    });
    
    // Load district zones & energy data availability tags
	loadDistrictZones( 0.1, 'assets/data/HelsinkiMajorDistrict.json', 'MajorDistricts' );
    
	//Experimental scripts for playing around with the objects, and retrieving their information...
	document.getElementById("cesiumContainer").addEventListener("click", function() { processClick( viewer, event ) });
	//Attaching UI events...
	addEventListener('input', ( event ) => { sliderEvents( event ) } );

  document.getElementById('blueSlider').addEventListener('input', function() {
    document.getElementById('sliderValue').textContent = 'distance from green area ' + this.value + ' km';
    handleGreenAreas( );
});

document.getElementById('ndviSlider').addEventListener('input', function() {
  document.getElementById('ndviSliderValue').textContent = 'ndvi';
  updateNDVIDataSources( );
});

document.getElementById('ndviSlider2023').addEventListener('input', function() {
  updateNDVIDataSources2023( );
});

document.getElementById('ndviArea').addEventListener('input', function() {
  updateNDVIAreaDataSources( );
});

document.getElementById('ndviYlre').addEventListener('input', function() {
  updateNDVIYlreDataSources( );
});

  //disable switch for showing heat exposure on nature areas

  const hriCredit = new Cesium.Credit('<a href="https://hri.fi/data/fi/dataset" target="_blank"><img src="assets/images/hero_logo_50x25.png" title="assets/images/Helsinki Region Infoshare"/></a>');
  const hsyCredit = new Cesium.Credit('<a href="https://www.hsy.fi/en/air-quality-and-climate/geographic-information/open-geographic-information-interfaces/" target="_blank"><img src="assets/images/hsy-logo_41x25px.png" title="HSY"/></a>');

  viewer.scene.frameState.creditDisplay.addDefaultCredit( hriCredit );
  viewer.scene.frameState.creditDisplay.addDefaultCredit( hsyCredit );

  toggleReturnButtonVisibility();

  </script>
</body>
</html>